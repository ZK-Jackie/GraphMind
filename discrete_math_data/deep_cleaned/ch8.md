# 第八章  图的基本理论与算法

若用点表示现实世界中事物、点之间连线表示事物之间联系，则可画出一个图来形象地表达问题模型。事实上，若将思维浓缩，图是最简洁的思维轨迹；若将思维展开，图能描述最复杂的思维蓝本。十八世纪著名数学家欧拉创造性地将具体问题抽象为图模型，建立一套关于图的数学理论——图论，使图模型成为一种非常有效且非常有趣的数学工具，实现了形象思维与抽象思维的完美结合、理论性与实用性的完美结合。图模型作为一种特殊的二元关系，诠释了复杂的多对多关系，揭示了各结点之间错综复杂的网状拓扑结构，具有强大的知识表达能力。正是这种强大的表达能力使得图模型在解决诸多复杂问题中发挥至关重要、不可替代的作用。本节首先学习图的概念与表示、图的运算与性质以及图的连通性质；然后介绍若干经典的图模型算法，包括图的遍历算法、单源和多源最短路径算法等；最后介绍图模型的应用。  

## § 8.1 图的概念与表示

前述关系理论涉及一种称之为图的几何模型，如关系图、哈斯图等。这种图模型由一些点和连接两点的线组成，主要用于表示事物之间一对多、多对多的复杂关系。与传统几何模型不同，对于图模型，我们感兴趣的只是其中有多少个点以及哪些点之间有线连接，至于线的长短曲直以及点的位置都无关紧要，即只考虑点和线之间的结构信息，不考虑点和线之间的位置信息。图模型作为对离散对象及其联系的一种直观抽象表示形式，广泛用于对现实问题的建模和求解。本节主要介绍图模型的由来、基本概念以及表示方法。  

### 8.1.1  图模型的由来  

俄罗斯加里宁格勒州的首府加里宁格勒，原名为哥尼斯堡，是一个具有悠久历史的小镇。有一条名为普雷格尔的小河横穿这个小镇，并且在河中间形成两个小岛。在十八世纪的时候，人们在这条河上建有七座桥，将河中两个岛与河的两岸联结起来，建成一个如图8-1 (a)所示的公园。人们闲暇时常在这个公园里散步，有一天其中有个人突发奇想，提出一个问题：一 个步行者怎样才能不重复、不遗漏地一次走完七座桥，最后回到出发点。问题提出后，很多人对此很感兴趣，纷纷进行试验，但始终未能解决。  

1735 年，有几名大学生写信给当时正在俄罗斯的彼得斯堡科学院任职的瑞士天才数学家欧拉，请他帮忙解决这一问题。欧拉在亲自观察了哥尼斯堡七桥，在经过为期一年的研究之后，29 岁的欧拉在1736 年提交了名为《哥尼斯堡七桥》的论文，圆满解决了这一问题。在论文中，欧拉将两个小岛和两岸构成的四块陆地分别抽象成结点，然后将连接这四块陆地的七座小桥分别抽象成连接这四个结点的边。

 我们知道，对于任意一个结点，如果它是出发结点，那么它必然要关联一条边使得散步者能够回到这个结点，如果这个结点不是出发点，那么这个结点必须要关联偶数条边以保证散步者能够进出这个结点，因为每条边只能通过一次，进出一次这个结点需要关联两条不同的边。根据以上思路，不难得到如下三条关于一笔画结论：  

1.如果一个连通图的每个结点都关联偶数条边，那么可以任一结点为起点，用一笔画完此图并该结点为终点；  

2.如果一个连通图只有两个结点关联奇数条边，其余结点均关联偶数条边，那么该图一定可以用一笔画成，此时，关联奇数条边的两个结点分别为起点和终点；  

3.不满足前两个条件的图都不能用一笔画出，此时将关联奇数条边的结点数除以二便可得到该图需用几笔才能画成。  

现在考察哥尼斯堡七桥问题，图中每个结点均关联奇数条边，因而无解。  

欧拉解决哥尼斯堡七桥问题的思路非常巧妙，是一种全新的建模方式。在完美解决哥尼斯堡七桥问题之后，欧拉对这种模型的性质以及相关的建模方式做了深入系统的研究并由此创立了一套新的数学理论——图论。

### 8.1.2 图的定义与分类

在众多应用领域中，例如各种关系的表示、作业的运筹规划与调度、网络技术的研究以及计算机程序的流程分析，都会遇到这种由“结点”和“边”组成的图模型。在用图模型对具体问题建模时，通常用结点表示事物对象，用结点之间的连线表示对象之间联系。因此，这里讨论的图模型与人们通常熟知的几何图形，如三角形、梯形、椭圆等有很大不同，是指某类具体离散事物集合以及反映该集合中每对事物之间某种联系的一种离散数学结构模型。  

对于这种图模型，感兴趣的只是其中有多少个结点以及哪些点之间有边相连，至于结点位置以及边的长短曲直都无关紧要。因此，从本质上说，图模型其实就是由结点和联结结点的边组成的一种特殊二元关系模型，用于表示一组对象以及这组对象之间的某种二元关系。由此得到如下关于图模型的数学定义：  

【定义8.1】由非空有限集合 $V$和有限多重集 $E$组成的二元组 $G$=$\left< V,E\right>\\$ 称为图模型，简称为图。其中：$V$=$\{v_1,v_2,v_3,\ldots,v_n\}$ 是一个非空有限集，$V$ 中元素称为图的结点；$E$是一个有限多重集，即$E=\{n_{1}\cdot e_{1},n_{2}\cdot e_{2},\cdots,n_{m}\cdot e_{m}\}$，$E$ 中每个元素$e_{i}$均是 $V$ 中一个或两个结点组成的结点对，称为图的边。  

从上述定义及例题可以看出，图模型表示的是有限集合𝑉上的某种二元关系$E$，如果两结点之间具有这种关系，则用边进行联结，否则它们之间就无边相联。  

值得注意的是，图模型的两个结点之间可能会有多条边相连。

【定义8.2】对于图 $G$ 中的任意一条边：如果该边是从结点 $u$出发到结点 $v$的有方向的边，则称其为有向边，用序偶$\langle u,v\rangle$ 表示，其中第一元素 $u$ 称为有向边的始点，第二元素$v$ 称为有向边的终点，$u$ 和 $v$ 也都称为有向边的端点；如果该边是连接 $u$ 和 $v$ 的无方向的边，称为无向边，用无序偶 $(u,v)$ 表示。其中 $u$ 和 $v$ 均称为无向边的端点。  

【定义8.3】在图 $G=\langle V,E\rangle$ 中，若两个结点 $u$ 和 $v$ 是边 $e$ 的端点，则称 $u$ 与 $v$ 互为邻接点，否则称为不邻接；以结点 $u$为端点的边，称为结点 $u$ 的关联边；具有公共结点的两条边称为邻接边；两个端点相同的边称为自环或自回路；不与任何结点相邻接的结点称为孤立结点；由孤立结点组成而没有边的图称为零图；仅含一个孤立结点而没有边的图，称为平凡图；含有   $n$ 个结点， $m$   条边的图称为   $(n,m)$   图。  

图模型是一种复杂的离散结构，可按不同的分类标准将其分成不同类型。一般根据有无方向、有无平行边、有无权重等标准对图模型进行分类。  

（1）无向图、有向图、混合图  

根据有无方向边，可将图划分为无向图、有向图和混合图，相关定义如下：  

【定义8.4】对于任意一个给定的图模型：如果它的每条边都是无向边，则称该图为无向图；如果它的每条边都是有向边，则称该图为有向图；如果图中有些边是无向边，有些边是有向边，则称该图为混合图。    

事实上，在没有特别或限定的情况下，也可将无向边看成是两条分别具备相反方向的有向边，相应地，可将无序偶$(u,v)$看成是两个有序偶$\langle u,v\rangle$和$\langle v,u\rangle$。因此，可将混合图转化为有向图。

（2）多重图、线图和简单图  

根据有无平行边，可将图划分为多重图、线图和简单图，相关定义如下：  

【定义8.5】对于任意一个有向图，如果两结点间（包括结点自身间），若有同始点且同终点的多条边，则称这些边为平行边；两结点间平行边的条数称为边的重数；含有平行边的图称为多重图；非多重图称为线图；无环的线图称为简单图。  

（3）赋权图、无权图  

根据边或结点是否有权，可以将图划分为赋权图和无权图，相关定义如下：  

【定义8.6】赋权图 $G$一般可记为三重组$\langle V,E,g\rangle$ ，其中 $V$ 是结点的集合，$E$ 是边的集合，$g$ 是从 $E$ 到非负实数集合的函数（对边赋权）。相应的有无向赋权图和有向赋权图之分。非赋权图称为无权图。  

### 8.1.3 图的表示方法  

如前所述，图模型其实就是一种特殊的二元关系。因此，图模型作为一种二元关系，一般来说具有三种基本的表示方法，即集合表示法、图形表示法和矩阵表示法。对于一个图模型G，若将其记为 $G=\langle V,E\rangle$ ，并枚举集合 $V$ 和 $E$ 中所有元素，则称这种表示方法为图的集合表示法。若画出$G$ 的图形，用小圆圈表示 $V$中的结点，用由 $u$ 指向 $v$ 的有向线段或曲线表示有向边 $\langle u,v\rangle$ ，无向线段或曲线表示无向边 $(\mathrm{u},\mathrm{v})$ ，则称该方法为图的图形表示法。  




集合表示法比较精确，但抽象且不易理解；图形表示法形象直观，但是当图中的结点和边的数目较大时，这种表示法很不方便甚至不可行。事实上，可以通过矩阵将图模型的逻辑结构转变成可在计算机中存储和运算的形式，并可设计一定的存储结构满足计算机处理的需要。因此，计算机系统通常使用矩阵实现对图的表示和处理。本节着重介绍图的矩阵表示法，具体包括邻接矩阵表示法、关联矩阵表示法、邻接表表示法等几种类型。  

#### 一、邻接矩阵表示法  

邻接矩阵是表示图结点间邻接关系的矩阵，即表示图模型中的各个结点之间是否有边的联结关系的关系矩阵。邻接矩阵的具体定义如下：  

【定义8.7】设$G=\langle V,E\rangle$是任一给定的图模型 ，其中结点集合$\ V=\{v_{1},v_{2},\ldots,v_{n}\}$，边集合$E=\{e_{1},e_{2},\dots,e_{m}\}$。称 $n$ 阶方阵 $A_{G}=(a_{i j})_{n\times n}$为图 $G$ 的邻接矩阵，如果矩阵元素 $a_{i j}$ 表示图中结点$v_{i}$ 和 $v_{j}$ 之间是否有边相连：若有则$a_{i j}$为边数$k$，否则$a_{i j}=0$。即有：  

$$
a_{i j}={\left\{\begin{array}{l l}{k,}&{{\mathbb{若}}(v_{i},v_{j}){\in}E{\mathbb{或}}\langle v_{i},v_{j}\rangle{\in}E}\\ {0,}&{{\mathbb{否则}}}\end{array}\right.}\quad\quad\quad\quad(i,j=1,2,3,\cdots,n)
$$ {      }

从上述定义可以看出，如果图$G=\langle V,E\rangle$是一个线图，则其邻接矩阵为布尔矩阵。此外，需要注意的是，要确定一个图的邻接矩阵，首先必须对图中的所有结点进行编号，邻接矩阵的表示与结点编号的次序紧密相关，不同的结点编号对应于不同的邻接矩阵，结点编号次序的交换对应于邻接矩阵行列的交换。  

事实上，无向图和有向图的关联矩阵有一些差异。例如，无向图的每条边不带方向，或理解为每条边同时具有两个方向，故其表示的二元关系具有对称性。因此，关系矩阵或者说图的关联矩阵是一个对称矩阵。对于有向图，其表示的二元关系不一定具有对称性，故其关联矩阵不一定是对称矩阵。因此，通常分别讨论无向图和有向图的邻接矩阵。  



#### 二、关联矩阵表示法  

除了邻接矩阵外，还可以用关联矩阵表示图。关联矩阵主要表示图中每个结点与每条边之间的相关关系。对于任意给定的一个图模型$G$，其关联矩阵$M(G)$中元素$m_{i j}$的含义是图中结点$v_{i}$是否关联边$e_{j}$，如果$v_{i}$不关联$e_{j}$，则$m_{i j}=0$，如果$v_{i}$关联$e_{j}$，则用某个非零数字表示$m_{i j}$，具体数字依据图模型的类型和点边关联方式确定。  

与邻接矩阵一样，要确定一个图的关联矩阵，首先应对图中的所有结点进行编号，不同的结点编号对应于不同的关联矩阵，结点编号次序的交换对应于关联矩阵中行的交换。  

首先给出无向图关联矩阵的定义：

【定义8.8】设$G=\langle V,E\rangle$是无向图 ，其中$\ V=\{v_{1},v_{2},\ldots,v_{n}\}$，$E=\{e_{1},e_{2},\dots,e_{m}\}$ ，则将$n\times m$阶矩阵$(m_{i j})_{n\times m}$称为 $G$ 的关联矩阵，记为 $M(G)$ 。其中元素$m_{i j}$ 表示图中结点 $v_{i}$ 与边 $e_{j}$ 的关联次数，具体定义如下：  
$$
m_{ij}=\begin{cases}2,v_i的自环是e_j\\[2ex]1,v_i关联e_j且e_j不是自环\\[2ex]0,v_{i}不关联e_{j}\end{cases}
(i=1,2,\cdots,n,\quad j=1,\:2,\:...,\:m)(8-2)
$$



从上述定义可以看出，无向图的关联矩阵用数字2 表示结点与边的自环关系，因为自环须与其关联结点关联 2  次。  

下面给出有向图关联矩阵的定义：  

【定义8.9】设 $D=\langle V,E\rangle$是有向图，其中 $V=\{v_{1},v_{2},\ldots,v_{n}\}$ ，$E=\{e_{1},e_{2},\dots,e_{m}\}$ ，则将${}n\times m$阶矩阵$(m_{i j})_{n\times m}$称为有向图 $D$ 的关联矩阵，记作 $M(D)$ 。 其中元素 $m_{i j}$ 表示图中结点 $v_{i}$ 与边 $e_{j}$ 的关联情况，具体定义如下： 

$$
m_{ij}=\begin{cases}-2,&v_i\text{为其关联自环}e_j\text{的起点和终点}\\1,&v_i\text{为其关联边}e_j\text{的起点但不是终点}\\-1,&v_i\text{为其关联边}e_j\text{的终点但不是起点}\\0,&v_i\text{不关联边}e_j\end{cases}
$$

从上述定义可以看出，有向图的关联矩阵用数字−2表示结点与边的自环关系。事实上，有时候也可以用2 表示。因为有向图的自环是有方向的，即顺时针或逆时针方向。习惯上，用正数表示逆时针方向，负数表示顺时针方向。图中的自环默认为顺时针方向，故一般用−2表示结点与边的自环关系。  

对于无向图及其关联矩阵，由于每条非自环边关联2 个结点，故矩阵中每列元素之和必为2。而对于有向图及其关联矩阵，由于每条非自环有向边关联2 个结点，且一个为起点一个为终点，故图中每个非自环边在关联矩阵中所对应列元素之和必为0。  

因此，可以通过分析关联矩阵的数据特征分析来分析图中结点与边之间的结构信息。例如，对于任意一个关联矩阵，如果某行元素全为零，当且仅当该行所对应的结点为孤立结点。 再如，如果第 $j$列与第 $k$列相同，当且仅当 $e_{j}$ 与 $e_{k}$ 是平行边，或者说重边对应的列完全相同。 后面将经常使用关联矩阵分析图模型的各种结构特征。  

#### 三、邻接表表示法  

对于一个图模型$G=\langle V,E\rangle$，当图中的边数较多时，邻接矩阵和关联矩阵都是比较有效的表示方法。然而，当图$G$中的边数较少时，邻接矩阵和关联矩阵的的表示方法就比较浪费资源。此时，可采用邻接表的方法表示图模型。  

邻接表分别对图$G=\langle V,E\rangle$中每个结点$v_{i}$建立一个单链表。对于结点$v_{i}$的单链表，该表的第一个存储单元为表头，存放结点$v_{i}$的有关信息，表中其它存储单元存放与所有结点$v_{i}$相关联边的信息。因此，每个单链表中都存放着图的某个结点及与该结点相关联的所有边，表中各个存储单元通过指针进行串接。图$G$中所有结点的单链表就构成图$G$的邻接表，该表是由单链表的表头形成的顶点表和单链表其余结点形成的边表两部分组成。  

显然，对于给定的结点数目，邻接表的规模与图模型边的数目紧密相关，当图中边的数目比较少时，邻接表的规模就比较小，此时使用邻接表表示和处理图模型就能够获得较高的效率。不过，邻接表的存储单元之间用指针链接，对表中数据进行定位和操作需要一定的编程技巧。

##  § 8.2 图的运算与结构

本节在前述图模型基本概念基础上介绍关于图模型处理的基本知识和方法，包括图模型的集合运算、图模型的度结构性质、图同构的概念及判定方法。对于图模型，可对其定义一些相关运算与操作产生新的图模型并据此实现对问题的分析和求解。此外，结构性质是对图模型进行理解和处理的基本依据，图中结点与边之间显然存在一些基本约束，例如一条边关联且仅关联两个结点，这些约束使得图模型在结构上必须满足一定数量关系，如握手定理，它们构成了图模型最基本的结构性质。最后，本节通过图同构映射的机制考察和处理两个图模型之间在结构上等价关系，同构的图模型具有完全相同的结构性质。  

### 8.2.1 图的基本运算

以图作为运算对象进行的运算称为图运算。在对图的实际应用中，可以根据图模型特点和问题求解的需要来定义各种图运算以产生新的图模型。本节主要介绍图的基本运算，具体包括图的集合运算、边点修改运算以及子图与补图运算等。  

#### 一、图的集合运算  

图模型作为一种特殊的集合具有并、交、差、补、环和等集合运算，下面分别介绍这些集合运算及其相关性质。 首先给出两个图不交、不重的定义：  

【定义8.10】假设 $G_{1}=\langle V_{1},E_{1}\rangle$和 $G_{2}=\langle V_{2},E_{2}\rangle$是任意给定的两个图模型，则有：  

（1）如果 $V_{1}\cap V_{2}=\varnothing$，则称 $G_{1}$ 与 $G_{2}$ 是不交的； 

（2）如果 $E_{1}\cap E_{2}=\varnothing$ ，则称 $G_{1}$ 与 $G_{2}$ 是边不交的，或者说是不重的。  

显然，对于任意两个不交的图它们必然是不重的，反之不然。  

下面给出图模型基本集合运算的定义：  

【定义 8.11 】假设   $G_{1}=\langle V_{1},E_{1}\rangle$ 和   $G_{2}=\langle V_{2},E_{2}\rangle$ 分别为不含孤立结点的图模型（它们 同为无向图或者同为有向图）。  

（1）令图 $G_{1}\cup G_{2}=\left\langle V,E\right\rangle$，称 $G_{1}\cup G_{2}$ 为 $G_{1}$ 与 $G_{2}$ 的并图，其中：$V=V_{1}\cup V_{2},\;\;E=E_{1}\cup E_{2}$  

当 $G_{1}$ 与 $G_{2}$ 不存在公共的边时，称 $G_{1}\cup G_{2}$ 为 $G_{1}$ 与 $G_{2}$  的不重并。  

（2）设图 $G_{1}\cap G_{2}=\langle V,E\rangle$，称 $G_{1}\cap G_{2}$ 为 $G_{1}$ 与 $G_{2}$ 的交图，其中：$V=V_{1}\cap V_{2},\,\,\,E=E_{1}\cap E_{2}$  

$G_{1}\cap G_{2}$是由 $G_{1},G_{2}$ 中所有公共的边组成的图。

（3）设图 $G_{1}-G_{2}=\langle V,E\rangle$，称 $G_{1}-G_{2}$ 为 $G_{1}$ 减 $G_{2}$ 的差图，其中：  
$$
V=V_{1},\,\,\,E=E_{1}-E_{2}
$$

$G_{1}-G_{2}$ 是在图 $G_{1}$ 中减去属于 $G_{2}$ 的边后所剩余的部分组成的图。

（4）环和图 $G_{1}\oplus G_{2}$ 是由 $G_{1}$ 与 $G_{2}$ 的并图减去 $G_{1}$ 与 $G_{2}$ 的交图后得到的图。  
$$
G_{1}\oplus G_{2}=(G_{1}\cup G_{2})-(G_{1}\cap G_{2})
$$

从上述定义可以看出，图模型的并、交、差、环和等集合运算其实就是普通集合运算的延伸。 需要注意的是：  

（1）若   $G_{1}=G_{2}$   ，则 $G_{1}\cup G_{2}=G_{1}\cap G_{2}=G_{1}(G_{2}),~~~~~G_{1}-G_{2}=G_{2}-G_{1}=\varnothing\,。$

（2）$G_{1}$ 与 $G_{2}$ 不重时，$G_{1}\cap G_{2}=\varnothing$，$G_{1}-G_{2}=G_{1}$，  $G_2-G_1=G_2, G_1\oplus G_2=G_1\cup $$G_{2}$。  

（3）两个图的环和可用并、差、交给出，$G_{1}\oplus G_{2}=(G_{1}\cup G_{2})-(G_{1}\cap G_{2})\,.$    

#### 二、图结构修改运算  

对于一个给定的图模型，有时会根据实际问题的需要对图的结构进行化简或修改，主要是添加或者删除图中的某个或某些边、将图中两个结点进行合并、删除图中的某个或某些结点等，由此得到如下四个常用的图结构修改运算或操作，即：边的添加运算（也称为加新边运算）、边的删除运算、边的收缩运算以及结点的删除运算。其具体定义如下：  

【定义8.12】设图 $G=\langle V,E\rangle$是一个任意给定的图模型（有向图或无向图），则$G=\langle V,E\rangle$的四个常用图结构修改运算定义如下：  

（1）加新边运算：设$u,v$是 图$G=\langle V,E\rangle$的任意两个结点，即 $u,v\in V$，将这两个结点构成的边$e$边添加到图 $G$ 的边集$E$中构成一个新图$G^{\prime}=\langle V,E\cup\{e\}\rangle$。  

（2）边的删除运算：设$e$是图$G=\langle V,E\rangle$的任意一条边，即 $e\in E$ ，从 $G$ 中删除边 $e$ 得到一个新图$G^{\prime}=\langle V,E-\{e\}\rangle$，记为 $G-e$ ；又$E^{\prime}$是图$G$中若干边组成的集合，即$E^{\prime}\subseteq E$从 $G$ 中删除 $\mathrm{E^{\prime}}$中所有边得到一个新图$G^{\prime}=\langle V,E-E^{\prime}\rangle$，记为 $G-E^{\prime}$ 。  

（3）边的收缩运算：设$.e$是图$G=\langle V,E\rangle$的任意一条边且该边关联的两个结点为$u,v$，从图中删除边$e$并将该边的两个端点$u,v$合并成一个新的结点$w$，使得结点$w$关联除$e$以外的$u$和$v$所关联的一切边，得到一个新图$G^{\prime}$，记为$G\backslash{\mathbf{e}}$  

（4）结点的删除运算：设$_v$是 图$G=\langle V,E\rangle$的任意一个结点，即 $v\in V$，从 $G$ 中删除 $v$及与𝑣相关联的所有边，得到一个新图$G^{\prime}$，记为 $G-v$，又设 $V^{\prime}\subseteq V$ ，从 $G$ 中删除 $V^{\prime}$中所有顶点及与这些顶点关联的所有边，得到一个新图$G^{\prime}$，记为 $G-V^{\prime}$。  

从上述定义可以看出，要删除边，则直接在图中将改变去掉即可；要删除结点，在去掉该结点的同时，还要去掉该结点关联的所有边；边的收缩实际上就是将改变的长度变为0，使其两个端点重叠，用一个新的结点𝑤代替，其它边不变，即$w$关联该边的两个端点关联的除该边外的一切边，不过，需要注意的是，边的收缩可能会产生自环或平行边；所谓加新边运算，就是在图中的两个结点之间直接拉一条边。    

#### 三、子图与补图运算  

在使用图模型对实际问题建模和求解的过程中，经常需要分析考察图的某个特定部分的结构，将图中某个或某些特定的部分提取出来作为一个图模型进行研究，由此得到如下关于图模型的子图运算的若干概念，具体如下：  

【定义8.13】设 $G=\langle V,E\rangle$，$G^{\prime}=\langle V^{\prime},E^{\prime}\rangle$是两个图（同为无向图或者有向图），则有：  

（1）若 $V^{\prime}\subseteq V$且 $E^{\prime}\subseteq E$，则称 $G^{\prime}$是 $G$ 的子图，$G$ 是 $G^{\prime}$的母图，记为 $G^{\prime}\subseteq\mathbf{G}$ 。若 $G^{\prime}\subseteq\mathbf{G}$且 $G^{\prime}\neq{\bf G}$（即$V^{\prime}\subset V$或 $E^{\prime}\subset\mathbf{E})$），则称 $G^{\prime}$ 是 $G$ 的真子图；若 $G^{\prime}\subseteq G$且 $V^{\prime}=V$，则称 $G^{\prime}$是 $G$ 的生成子图。  

（2）设$V_{1}$是𝑉的非空子集，即 $\varnothing\neq V_{1}\subseteq V$，则以 $V_{1}$ 为结点集，以两个端点均在 $V_{1}$ 中的全体边为边集的 $G$ 的子图称为由$V_{1}$导出的导出子图，记为 $G[V_{1}]$。  

（3）设$E_{1}$是$E$的非空子集，设$\varnothing\neq E_{1}\subseteq E$，以 $E_{1}$为边集，以 $E_{1}$ 中所有边关联的全部结点为结点集的 $G$ 的子图成为由 $E_{1}$导出的导出子图，记为 $G[\ E_{1}]$。  

由上述定义可以看出，生成子图与其母图具有相同的结点集合。因此，一个图的生成子图一般是该图的主体结构。对于一个复杂的图模型，一般通过采用适当的方法构造其符合要求的生成子图实现对模型的化简和对问题的求解。    

如前所述，图是非空有限集合上的二元关系。 由关系模型的相关理论可知，对于任一非空有限集合，都存在两个平凡关系，即全关系和空关系。所谓全关系，就是集合中任意两个元素之间都存在这种关系，其对应的关系图中任意两个结点有边互联，称之为完全图。所谓空关系，就是集合中任意两个元素之间都不存在这种关系，其对应的关系图中任意两个结点没有边互联，即为零图。    

不难看出，对于任一给定非空有限结点集合，由这些结点构成的零图和完全图分别表达了两个极端构图情形，两者之间具有互补性，相当于集合论中的空集和全集。 由此可以得到图模型补运算的概念。 首先给出如下关于完全图的定义：  

【定义8.14】假设$G=\langle V,E\rangle$是一个具有$\cdot_{n}$个结点的无向简单图，如果图中任意两个结点之间都有边相联结，则称该图为$^n$阶无向完全图，简称为完全图，记为$K_{n}$；假设$G=\langle V,E\rangle$是一个具有$\cdot_{n}$个结点的有向简单图，如果图中任意两个结点之间都有方向相反的两条边相联结，则称该图为$n$阶有向完全图，在不发生混淆的情况下也记为$K_{n}$。  

由上述定义可知，对于完全图来说，其邻接矩阵除主对角线上元素均为0 之外，其余元素均为1。显然，$n$阶无向完全图的边数为$n(n-1)/2$ ，$n$阶有向完全图的边数为$\ n(n-1)$。 图8-17 给出了无向完全图$K_{3}$，$K_{4}$，$K_{5}$和有向图$K_{3}$。  

下面给出图模型补运算的定义：  

【定义8.15】设 $G=\langle V,E\rangle$ 是 $n$ 阶简单图，以 $V$ 为顶点集，以所有能使 $G$ 成为完全图 $K_{n}$ 的新加边为边集的图称为 $G$ 相对于 $K_{n}$ 的补图，简称为 $G$ 的补图，记为$\bar{G}$。  

显然，若图$G$的邻接矩阵为$A_{G}=(a_{i j})_{n\times n}$，则其补图$\bar{G}$的邻接矩阵为$A_{\bar{G}}=(\bar{a}_{i j})_{n\times n}$为：  

$$
\\\bar{a}_{i j}=f(x)=\left\{\begin{array}{r l r}&{~~~~~~~~1-a_{i j},~i\neq j}&\\ &{0,~~~~~~~~~~~~~~~~~~i=j}&\end{array}\right.
$$

### 8.2.2 图模型的度结构  

现在我们考察图模型的结构特征。从结构上看，对于任意给定的一个图模型，只要该图不是零图，总会有一些点与一些边相互联结。从生成子图的概念可以看出，图的结点构成了图模型的骨架或主体结构，因此，我们主要从结点出发考察每个结点所关联的边关联多少条边。为此，对于图中的每个结点，都定义一个数来描述该结点所关联边的个数，这就是结点度的概念，其具体定义如下：  

【定义8.16】假设图 $G=\langle V,E\rangle$是任意给定的一个无向图，对于$G$中任意一个结点 $v$ ，与该结点关联边的条数称为该结点的度数，简称为度，记为 ${\sf d e g}(v)$。图$G$中各个结点度数的最大值称为图$G$的最大度，记为$\Delta(G)$；图$G$中各个结点度数的最小值称为图$G$的最小度，记为$\delta(G)$ $\Delta(\mathrm{G})=\mathrm{max}\{\mathrm{deg}(\mathrm{v})|v_{\in}V(G)\};\,\,\,\delta(\mathrm{G})=\mathrm{min}\{\mathrm{deg}(\mathrm{v})|v_{\in}V(G)\}\,.$  

【定义8.17】设图 $G=\langle V,E\rangle$是任意给定的一个有向图，$v$是$G$中任一结点，则有：  

（1）以该结点为起点的有向边的条数，称为该结点的出度，记为$\deg^{+}(v)$；以该结点为终点的有向边的条数，称为该结点的入度，记为 $\deg^{-}(v)$。  

（2）该结点的出度与入度之和称为该结点的度，记为${\sf d e g}(v)$。 即有：  

$$
\deg(v)=\deg^{+}(v)+\deg^{-}(v)
$$

（3）图$G$中各个结点出度与入度的最大值分别称为图$G$的最大出度和最大入度，分别记为$\Delta^{+}(\mathsf{G})$和 $\Delta^{-}(\mathsf{G})$；图$G$中各个结点出度与入度的最小值分别称为图$G$的最小出度和最小入度，分别记为$\Delta^{+}(\mathbf{G})$和 $\Delta^{-}(\mathsf{G})$，即有：  

$\Delta^{+}(\mathrm{G})=\operatorname*{max}\{\deg^{+}(v)|v\!\in\!V(G)\};\,\,\,\Delta^{-}(\mathrm{G})=\operatorname*{max}\{\,\,\deg^{-}(v)|v\!\in\!V(G)\}$ $\delta^{+}(\mathrm{G})=\operatorname*{min}\{\deg^{+}(v)|v\!\in\!V(G)\};\,\,\,\delta^{-}(\mathrm{G})=\operatorname*{min}\{\,\,\deg^{-}(v)|v\!\in\!V(G)\}$  

从上述定义可以看出，引入度结点度概念的目的主要是通过对图中每个结点所关联边数进行统计分析来考察图模型的结构特征。  

【定义8.18】对于任意一个给定的有向图或无向图  $G=\langle V,E\rangle$ ，图中度数为1 的结点称为该图的悬挂结点，图中以悬挂结点为端点的边称为该图的悬挂边。如果图$G$中各个结点的度数均相同，则称该图正则图，各结点度均为$\ k$的正则图称为$\pmb{k}$-正则图。  

假设 $G=\langle V,E\rangle$是任意给定的一个有向图或无向图，其中$V=\{v_{1},v_{2},\ldots,v_{n}\}$，$E=$$\{e_{1},e_{2},\ldots,e_{m}\}$。 $G$的邻接矩阵为：  

$$
A=(a_{i j})_{n\times n}=\left(\!\!{\begin{array}{c c c c}{a_{11}}&{a_{12}}&{\ldots}&{a_{1n}}\\ {a_{21}}&{a_{22}}&{\ldots}&{a_{2n}}\\ {\vdots}&{\ddots}&{\vdots}\\ {a_{n1}}&{a_{n2}}&{\ldots}&{a_{n n}}\end{array}}\!\!\right)
$$

则有如下结论：  

（1）如果$G$是无向图，那么邻接矩阵𝐴中第𝑖行元素之和表示结点$v_{i}$的度数，第𝑗列元素之和表示结点$v_{j}$的度数。即有：  

$$
\deg(v_{i})=\sum_{k=1}^{n}a_{i k}+a_{i i};~~~~\deg\bigl(v_{j}\bigr)=\sum_{k=1}^{n}a_{k j}+a_{j j}
$$

（2）若G是有向图，那么邻接矩阵$A$中第𝑖行元素之和表示结点$v_{i}$的出度，第$j$列元素之和表示结点$v_{j}$的入度。简单地说，就是竖入横出。即有：  

$$
\deg^{-}(v_{i})=\sum_{k=1}^{n}a_{i k}+a_{i i};\qquad\deg^{+}\!\left(v_{j}\right)=\sum_{k=1}^{n}a_{k j}+a_{j j}
$$

（3）对于有向图G，注意到：  

$$
\sum_{j=1}^{n}\;\deg^{-}\!\left(v_{j}\right)=\sum_{i=1}^{n}\sum_{j=1}^{n}a_{i j}=\sum_{i=1}^{n}\deg^{+}\!\left(v_{i}\right)
$$

因此，有向图中所有入度之和等于所有出度之和，这个和其实就是图的边数$m$。因为有向图的每条边均产生且仅产生一个出度和一个入度。  

关于图中结点度数与边的关系，有如下著名的图论基本定理：  

【定理8.1】（握手定理）假设$G=\langle V,E\rangle$是任意给定的一个有向图或无向图，则该图中结点度数的总和等于边数的二倍，即有：  

$$
\sum_{v\in V}\deg(v)=2|E|
$$

【推论8.1】图中度数为奇数的结点个数必为偶数。  

图模型中结点的度从一种定量的角度反映了图中结点与边之间的制约关系，在一定程度上刻画了图模型的结构特征。为了更加方便地描述图模型中各个结点的度结构信息，下面给出度序列的概念：  

【定义8.19】假设$G=\langle V,E\rangle$是任意给定的一个有向图或无向图，图中每个结点的图构成的自然数序列称为$G$的度序列。也就是说，若 $V=\{v_{1},v_{2},\ldots,v_{n}\}$，则称序列：  

$$
(\deg(v_{1})\,,\deg(v_{2})\,,\cdots,\deg(v_{n}))
$$

为图 $G$ 的度数序列，简称为度序列。 此外，对于任意一个给定的自然数序列，如果该序列能够成为某个图的度序列，则称该序列为可图化序列。  

   

由于图模型的度要满足握手定理等基本约束要求，而且对于不同类型的图，其度序列也会有一些相应的数据特征。因此，并不是任意的自然数序列都可以构成图模型的度序列。对于任意给定的自然数序列，需要通过分析其数据特征来判断其是否为可图化序列。若是可图化序列，则可依据该序列数据来分析其所对应图的结构特征。  



### 8.2.3 图同构及其判定  

前面我们讨论了单个图模型的结构性质。有时候需要比较两个图在结构上的差异和相同之处。 由于在图模型的定义中，不考虑图中结点之间的位置关系和图中边的长短，因此可能会出现表面上很不相同，但是结构却完全相同的两个图模型。   

不难发现，对于这三对表面不同而结构相同的图模型，每对图模型之间的差异仅在于两者结点的排列次序不同，其它方面都相同。也就是说，两个图模型的结点之间存在一种双射关系，图的结构在这种双射关系下保持不变。由此得到如下同构的概念：  

【定义8.20】假设$G=\langle V,E\rangle$和$G^{\prime}=\langle V^{\prime},E^{\prime}\rangle$是任意给定的两个简单无向图或有向图，若存在双射函数 $g\colon V\to V^{\prime}$，使得：  

则称 $G$ 与 $G^{\prime}$之间具有同构关系，简称为$G$ 与 $G^{\prime}$同构，记为 $G\cong G^{\prime}$。 此时，映射$g\colon V\to$$V^{\prime}$ 称为   $G$   与   $G^{\prime}$ 之间同构映射。  

到目前为止，还没有找到判定两个图是否同构的有效方法，只能对一些简单图根据定义进行判别，具体地说，就是寻找同构图之间的不变量，例如：结点数相同、边数相同、度数相同的结点个数相同、同构映射对应点的度相同、同构映射对应点的所有邻接点分别具有相同的度，等等，不再一一枚举。不过这些不变量只是必要条件而非充分条件，因而一般首先使用这些条件判定两个图之间不同构，如果不能确定不同构，则转而使用各种方法寻找两者之间的同构映射，证明两者同构。  

值得注意的是，两个图的外观比较相似并不能说明两者一定是同构的。

##  § 8.3 图的通路与连通性

### 8.3.1 通路的概念与计数  

前面我们讨论的图模型结构主要是图中结点与边的性质与联系，考察结点之间是否有边联结，换句话说，就是考察图中结点与结点之间的直接联系或直接关系。

【定义8.21】设$G=\langle V,E\rangle$ 是任意给定的一个有向图或者无向图，$\boldsymbol{T}$为图$G$ 中顶点和边的相继交替出现的序列，即$\varGamma=v_{0}e_{1}v_{1}e_{2}v_{2}\ldots e_{k}v_{k}\,$。如果对于$i=1,2,\cdots,k$，均有${v_{i-1}}$ 和 $v_{i}$ 是 $e_{i}$ 的两个端点（当 $G$ 为有向图时，要求 $v_{i-1}$ 为 $e_{i}$ 的始点，${v}_{i}$ 为 $e_{i}$ 的终点），则称 $\varGamma$为结点 $v_{0}$ 到结点 $v_{k}$ 的一条通路，$v_{0}$ 和 $v_{l}$ 分别称为该通路的始点和终点，统称为通路的端点。通路$T$ 中所含边的数目 $k$称为$ T$ 的长度。当 $v_{0}=v_{k}$ 时，称该通路称为回路。  

在上述定义中，回路是一种特殊的通路，即起点等于终点的通路。但是，在习惯上我们所说的通路一般都不包含回路，也就是说不是回路的通路。因此，以后除非特别说明，我们所说的通路均是指不是回路的通路。  

下面定义通路和回路的各种类型：  

【定义8.22】设$G=\langle V,E\rangle$ 是任意给定的一个有向图或者无向图，$\boldsymbol{T}$为图$G$ 中分别以$v_{0}$和$v_{k}$为起点和终点的通路，即$\varGamma=v_{0}e_{1}v_{1}e_{2}v_{2}\ldots e_{k}v_{k}$，则有：  

（1）若 $\Gamma$ 中所有边各异，则称 $\Gamma$为简单通路或简单路径；若 $$\Gamma$$ 中所有边各异且$\boldsymbol{v}_{0}=$$\boldsymbol{v}_{k}$ 时，称 $$\Gamma$$为简单回路。  

（2）若 $\Gamma$中除 $v_{0},v_{k}$ 以外的所有结点各异（从而所有边也各异），则称 $$\Gamma$$  为基本通路或者基本路径。若 $v_{0}=v_{k}$ 且除 $v_{0},v_{k}$ 以外的所有结点各异，则称 $$\Gamma$$  为基本回路或者圈。  

（3）若 $\Gamma$  中有边重复出现，则称其为复杂通路，若还有 $v_{0}=v_{k}$ ，则称其为复杂回路。  

显然，基本通路必定是简单通路，基本回路必定是简单回路，反之不然。  

【定理8.2】假设 $G=\langle V,E\rangle$ 为任意给定的一个有向或者无向线图，并且其结点集合为

 $V=\{v_{1},v_{2},\ldots,v_{n}\}$，矩阵$A=(a_{i j})_{n\times n}$是图 $G$ 的邻接矩阵，则对于$A$的$m$次幂$A^{m}=$$({a_{i j}}^{})_{n\times n},m=1,2,\cdots,n,$，其元素 ${a_{i j}}^{(m)}$ 表示从结点 $v_{i}$ 到 $v_{j}$ 且长度为 $m$ 的通路数目；

${a_{i i}}^{(m)}$表示从结点 $v_{i}$ 到其自身长度为 $m$ 的回路数目；$\begin{array}{r}{\sum_{i=1}^{n}\sum_{j=1}^{n}{a_{i j}}^{(m)}}\end{array}$为图G中长度为 $m$ 的通路（包括回路）总数。  

根据以上分析和讨论，我们可以得出这样的结论：对于任意一个有向或者无向的线图，都根据其邻接矩阵的方幂运算获得任意两个结点在任意指定长度下的通路和回路的数目。

### 8.3.2 可达性及其判定  

如前所述，对于任意一个给定的线图模型，图中任意两个指定结点之间的通路可能有很多条，有的可能会长一些，有的可能会短一些，此时，一般关心的是哪条通路最短。还有一种情况，就是图中可能存在两个或者多个结点，它们之间根本没有通路相联结。由此得到结点可达性及其短程线的相关概念  

【定义8.23】假设 $G=\langle V,E\rangle$ 为任意给定的一个有向或无向线图，并且其结点集为 $V=$$\{v_{1},v_{2},\dots,v_{n}\}$，对于𝑉中的任意两个结点$v_{i},v_{j}$，如果从$\boldsymbol{.}\boldsymbol{v}_{i}$到$v_{j}$之间存在长度至少为1 的通路，则称从$v_{i}$到$v_{j}$可达，否则称从$v_{i}$到$v_{j}$不可达。 如果图$G$ 中从$v_{i}$到$v_{j}$可达，则从$v_{i}$到$v_{j}$长度最短的通路称为从$v_{i}$到$v_{j}$的短程线，该短线程的长度称从$\boldsymbol{v}_{i}$到$v_{j}$的距离，记为 $d\big(v_{i},v_{j}\big)$ 。如果从$\boldsymbol{v}_{i}$到$v_{j}$不可达，则记为 $d\bigl(v_{i},v_{j}\bigr)=\infty$ 。  

从上述定义可以看出，结点之间的可达性刻画的是图中两个结点之间的某种连通性关系。对于无向图来说，这种连通性关系显然是双向的，故若从$\boldsymbol{.}\boldsymbol{v}_{i}$到$v_{j}$ 可达，则从 $v_{j}$ 到 $v_{i}$ 可达，反之亦然；且有$d\bigl(v_{i},v_{j}\bigr)=d\bigl(v_{j},v_{i}\bigr)$ 。对于有向图来说，这种连通性关系不一定满足对称性，故若从$v_{i}$到$v_{j}$ 可达，则不一定有从 $v_{j}$ 到 $v_{i}$ 可达，也不一定有 $d\big(v_{i},v_{j}\big)=$$d\big(v_{j},v_{i}\big)$ 。  

【定理8.3】假设 $G=\langle V,E\rangle$ 为任意给定的一个有向或无向线图，并且其结点集为 $V=$$\{v_{1},v_{2},\dots,v_{n}\}$，若对于图中两个不同的结点$u$ 和 $v$，存在一条从$u$到 $v$通路，则必然存在一条长度不大于$:n-1$ 的基本通路。  

【定理8.4】假设 $G=\langle V,E\rangle$ 为任意给定的一个有向或无向线图，并且其结点集为 $V=$$\{v_{1},v_{2},\dots,v_{n}\}$，若对于图中结点$v$，存在一条从$v$ 到 $v$回路，则必然存在一条长度不大于$^{\cdot n}$ 的基本回路。  

【定理8.5】假设 $G=\langle V,E\rangle$ 为任意给定的一个有向或无向线图，并且其结点集为 $V=$$\{v_{1},v_{2},\dots,v_{n}\}$，$A=(a_{i j})_{n\times n}$为图 $G$ 的邻接矩阵，令：  

$$
B_{n}=(b_{i j}^{(n)})_{n\times n}=A+A^{2}+\cdots+A^{n}
$$

则当$v_{i}\neq v_{j}$时，若${b_{i j}}^{(n)}>0$，则$v_{i}$到$v_{j}$可达，否则不可达，且有：  

$$
d\big(\boldsymbol{v}_{i},\boldsymbol{v}_{j}\big)==\begin{cases}\infty,&&\text{若}a_{ij}{}^{(1)},a_{ij}{}^{(2)},\cdots,a_{ij}{}^{(n)}\text{均为 0}\\\min\{a_{ij}^{(m)}|m=1,2,\cdots,n\},&&\text{否则}\end{cases}
$$

在图模型的实际应用过程中，很多时候只需知道结点之间是否可达，而无需知道距离及通路数，由此得到如下可达性矩阵的定义：  

【定义8.24】假设 $G=\langle V,E\rangle$ 为任意给定的一个有向或无向线图，并且其结点集为 $V=$$\{v_{1},v_{2},\dots,v_{n}\}$，结点之间的顺序为$v_{1},v_{2},\dots,v_{n}$，则令$P=(p_{i j})_{n\times n}$是一个$n$阶矩阵，且满足：  

$p_{ij}=\begin{cases}1\:,~~~~~~结点从v_{i}到v_{j}至少存在一条长度不小于1的通路\\0\:,~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~否则\end{cases}$  

称矩阵 $P$ 为图 $G$ 的可达性矩阵。  

从上述定义可以看出，可达性矩阵中的元素$\cdot p_{i j}$表示了从$\boldsymbol{.}\boldsymbol{v}_{i}$到$v_{j}$的可达性关系，表达了结点之间通过结点邻接关系的传递性得到可达性关系。因此，图中结点之间的可达性关系就是该图所表达邻接关系的传递闭包，可达性矩阵其实就是图邻接关系的传递闭包关系矩阵，即为可达性关系的关系矩阵。 显然，无向图的可达性矩阵为对称矩阵。  

【定理8.6】假设 $G=\langle V,E\rangle$ 为任意给定的一个有向或无向线图，并且其结点集为 $V=$$\{v_{1},v_{2},\dots,v_{n}\}$，结点之间的顺序为$v_{1},v_{2},\dots,v_{n}$，矩阵$A$和$P$分别是图$G$在该结点次序下的邻接矩阵和可达性矩阵，则有：  

$$
P=A^{(1)}\lor A^{(2)}\lor\cdots\lor A^{(k)}\lor\cdots\lor A^{(n)}
$$

其中$A^{(k)}$表示进行矩阵$A$的$k$次布尔幂运算。  

### 8.3.3  无向图的连通性

前面我们学习了图的可达性概念及其判定，其描述的是图中两个结点之间是否可以通过一条或者多条通路进行联结，并从图的局部角度分别考察两个结点之间的连通关系。现在我们从全局性角度考察整个图中多个结点之间的连通关系，将两个结点之间的可达性概念推广到整个图中任意两个结点之间的可达性，由此得到图的连通性和连通图的相关概念。  

在图的连通性方面，无向图和有向图之间具有很大的差异。因此，我们分别讨论无向图和有向图的连通性。本小节主要介绍和讨论无向图连通性的概念与性质。首先给出无向图连通图的相关概念，具体定义如下：  

【定义8.25】设 $G=\langle V,E\rangle$ 为任一给定的无向图，对于图中的两个结点$v_{i}$ 与 $v_{j}$，如果从$\boldsymbol{v}_{i}$到$v_{j}$是可达的，则称从 $v_{i}$ 到 $v_{j}$是连通的，表示为[ $v_{i}\ \ ,v_{j}]$。规定图中任何结点与其自身是连通的。如果无向图$G$中任何两个结点之间都是连通的，则称该图为无向连通图或连通无向图，简称为连通图；否则，称$G$ 是非连通无向图，简称为非连通图。    

【定理8.7】设 $G=\langle V,E\rangle$ 为任一给定的无向图，其结点集为 $V=\{v_{1},v_{2},\ldots,v_{n}\}$，令$R$ 是集合$\cdot V=\{v_{1},v_{2},\ldots,v_{n}\}$上结点之间的连通关系，即有：  

$R=\{\langle u,v\rangle|u,v\in V\}$, 且从$u$到𝑣连通}       （8-10）  

则$R$是集合𝑉上的一个等价关系。   

【定义8.26】设 $G=\langle V,E\rangle$ 为任一给定的无向图$R$是图$G$结点集合𝑉上的连通性关系，则以关系𝑅的每个等价类为结点集的导出子图都称为图$G$的一个连通分支，并用$p(\mathbf G)$表示图𝐺的连通分支总数。  

由上述定义可知，如果无向图$G=\langle V,E\rangle$的结点连通性关系$R$作为一个等价关系，将结点集𝑉划分为$k$个不同的等价类$V_{1},V_{2},\ldots,V_{k}$，则由它们导出的子图$G(V_{1}),G(V_{2}),\cdots,G(V_{k})$均为图$G$的连通分支。因此，可以根据无向图中结点之间的连通关系实现对图模型的一个分解。显然，若   $p(G)=1$ ，则 $G$ 是连通图。若   $p(G)>1$ ，则   $G$ 是非连通图。 

【定义8.27】对于任意给定的一个无向图 $G=\langle V,E\rangle$，若存在结点集𝑉的某个子集 $V^{\prime}\subseteq$$V$ ，使得 $p(G-V^{\prime})>p(G)$ ，且对于 $V^{\prime}$的任何真子集 $V^{\prime\prime}$，有 $p(G-V^{\prime\prime})=p(G)$，则称 $V^{\prime}$为 $G$ 的点割集。如果点割集中只有一个结点 $v$ ，则称 $v$ 为割点。  

【定义8.28】 对于任意给定的一个无向图 $G=\langle V,E\rangle$，若存在边集$E$的某个子集 $E^{\prime}\subseteq$$E$ ，使得 $p(G-\ E^{\prime})>p(G)$ ，且对于 $E^{\prime}$的任何真子集 $E^{\prime\prime}$，有 $p(G-\ E^{\prime\prime})=p(G)$，则称$V^{\prime}$为 $G$ 的边割集。如果点割集中只有一个条边  $e$ ，则称 $e$为割边或桥。  

关于点割集与边割集，需要注意以下几个要点：  

（1）完全图 $K_{n}$ 无点割集，因为从 $K_{n}$ 中删除 $k\leq n-1$个顶点后，所得图仍然是连通的。  

（2）$n$ 阶零图既无点割集也无边割集。  

（3）对于连通图 $G$，$E^{\prime}$为 $G$ 的边割集，则必有 $p(G-E^{\prime})=2$ 。 因为删除一条边最多只能增加一个连通分支。  

（4）对于连通图 $G\ \ ,V^{\prime}$为 $G$ 的点割集，则 $p(G-V^{\prime})\geq2$，而且可能 $p(G-E^{\prime})>2$因为删除一个结点可能增加多个连通分支。  

【定义8.29】对于任意给定的一个无向连通图 $G=\langle V,E\rangle$，令：$\kappa(G){=}m i n\{|V^{\prime}||V^{\prime}$为G 的点割集}；$\lambda(\mathbf{G})=\operatorname*{min}\{|E^{\prime}||E^{\prime}$为G 的边割集} 并称 $\kappa(G)$ 为图 $G$ 的点连通度，$\lambda(G)$ 为图 $G$ 的边连通度。  

关于无向连通图的点连通度$\kappa(G)$和边连通度$\lambda(\mathrm{G})$，需要注意以下几个要点：

（1）如果 $G$是平凡图或非连通图，则规定 $\kappa(G)=\lambda(G)=0;$

（2）如果$G$ 是完全图 $K_{n}$ ，由于 $G$ 中无点割集，当删除 $n-1$个顶点后，$G$ 为平凡图，故 $\kappa(G)=n-1$。  

（3）如果 $G$ 中存在割点，则 $\kappa(G)=1$；如果 $G$ 中存在割边，则 $\lambda(G)=1$。对于任何无向图 $G$ ，其点连通度 $\kappa$ 、边连通度 $\lambda$ 与结点最小度 δ 之间有如下关系：

【定理8.8】对于任一无向图$G=\langle V,E\rangle$ ，均成立下列不等式：  
$$
\kappa(G)\leq\lambda(G)\leq\delta\ (G)
$$



### 8.3.4 有向图的连通性  

现在讨论有向图的连通性。与无向图不同的是，有向图中的每条边都具有方向性，结点之间的可达性关系不一定满足对称性。因此，有向图的连通性质比无向图更加复杂，一般要分为强连通、单向连通和弱连通这三种基本情况讨论，其具体定义如下：  

【定义8.30】假设$G=\langle V,E\rangle$任意给定的一个有向图，则有：如果图 $G$中任意两个结点之间都是相互可达的，则称 $G$ 是强连通图；如果图 $G$ 中任意两个结点中至少有一个结点到另一个结点可达，则称 $G$ 是单向连通图，简称为单连通图；对于略去图 $G$ 中各边的方向得到的无向图 $G^{\prime}$，如果 $G^{\prime}$ 是无向连通图，则称 $G$ 是弱连通图，简称为连通图。  

【定理8.9】（连通性定理）有向图 $G$ 是强连通图的充要条件是存在一条经过图$G$所有结点的回路；有向图 $G$ 是单连通图的充要条件是存在一条经过图𝐺所有结点的通路。  

【定义8.31】假设$G=\langle V,E\rangle$任意给定的一个有向图，设 $G^{\prime}$是 $G$ 的一个子图，如果$G^{\prime}$是强连通的（单向连通的、弱连通的），并且对 $\forall G^{\prime\prime}\subseteq G$，若$G^{\prime}\subset G^{\prime\prime}$，则 $G^{\prime\prime}$不是强连通的（单向连通的、弱连通的），则称 $G^{\prime}$ 为 $G$ 的强连通分支（单向连通分支、弱连通分支），简称为强分图（单分图、弱分图）。  

显然，强分图、单分图、弱分图都是 $G$ 的子图，可以用结点集合𝑉的子集导出。显然，强分图是单分图和弱分图，单分图一定是弱分图，但是为了强调它们之间的差异性，一般不再将强分图称为单分图或弱分图，也不再将单分图称为弱分图。  

可分别通过强分图、单分图、弱分图的概念对有向图中所有结点进行分组。具体地说：  

（1）对于由强连通关系产生的强分图，由于有向图结点之间的强连通关系显然满足自反性、对称性和传递性，因此这种强连通关系是一种等价关系，从而可由此等价关系实现对图中所有结点的划分。显然，每个强分图其实就是一个等价类或者划分块，图中所有的强分图就是构成了所有的划分块。 因此，有向图的任何一个结点属于且仅属于一个强分图。  

（2）对于由弱连通关系产生的弱分图，可类似于无向图的方法进行讨论。事实上，不难看出，弱分图其实就是有向图所导出无向图中的连通分支。因此，所有的弱分图也构成了有向图中所有结点的一种划分，有向图的任何一个结点属于且仅属于一个若分图。  

（3）对于由单向连通关系产生的单分图，不难证明，有向图结点之间的单连通关系满足自反性、对称性，但不满足传递性，因而是一种相容关系。可由此相容关系实现对图中所有结点的最大覆盖。显然，每个强分图其实就是一个最大相容类，图中所有的单分图就是构成了所有的最大相容类。因此，有向图的任何一个结点至少属于一个强分图。  

类似地，可分别通过强分图、单分图、弱分图的概念对有向图中所有边进行分组。 不难发现：对于任何一个给定的有向图，它的每条边至多属于一个其强分图，至少属于一个其单分图，属于且仅属于一个其弱分图。  

例如，对于例题8.30 中的强分图、单分图和弱分图，不难看出它们均满足上述所有关于结点和边分组性质。  

## §  8.4 图模型的基本算法

### 8.4.1  深度优先搜索  

图的遍历是指从图中的任一结点出发，按照一定的搜索方式对图中的所有结点进行访问，每个结点访问一次且仅一次。图的遍历是关于图的一种最基本的操作，图的许多其他操作都是建立在图的遍历基础之上。一般来讲，根据搜索路径的不同，图的遍历算法有两种基本类型，即深度优先搜索遍历和广度优先搜索遍历。  

深度优先搜索是按照深度方向进行搜索，对于一个给定的连通图$G=\langle V,E\rangle$，首先确定一个遍历的出发点$v_{i}$ ,将其标记为已访问之后，再次选择与点$v_{i}$相邻并且尚未访问过的结点$v_{j}$作为新的遍历；同样地，标记$v_{j}$为已访问之后，再次选择与点$v_{j}$相邻并且尚未访问过的新结点$v_{k}$作为遍历点，以此类推，直到图中所有的结点全部被访问，搜索过程完成为止。  

如果在遍历过程中，遇到了与当前遍历点相邻但已访问的结点，则直接跳过该点，再次选择匹配与当前遍历点相邻的其他点，直到找到未被访问的点进行下一次的深度遍历为止，在此过程中，如果已搜索完与当前遍历点所有的邻接点都没有找到未被访问的结点，则此层遍历结束，算法返回上一层遍历点继续深度搜索，以此类推，直到搜索过程完成为止。这个过程称为连通图的深度优先搜索，简称为$\pmb{D F S}$。  

上述算法讲述了对于连通图$G=(V,E)$的深度优先遍历过程，下面对其进行整理并拓广为非连通图的情况下的算法整理如下：  

（1）首先确定一个出发点$v_{i}$，访问并将其标记为已访问。  

（2）找出与结点$v_{i}$相邻且未被访问的邻接点$v_{j}$，访问并标记其为已访问，再以$v_{j}$作为当前遍历点继续访问与$v_{j}$相邻切未被访问的邻接点。递归重复本过程，直到当前遍历点的所有邻接点都被访问为止。  

（3）返回上一层访问过的遍历点，若此遍历点仍没有尚未被访问的邻接点，则继续返回上一层直到找到尚有未被访问的邻接点的遍历点，继续执行步骤（2），否则执行步骤（4）  

（4）若此时图中还有顶点未被访问，则继续选择图中一个未被访问的顶点作为起始点，重复上述描述过程，直至图中所有顶点均被访问过为止。  

在对图进行深度优先遍历时，按照结点的先后的被访问次序所组成的序列，称为深度优先搜索序列，简称𝑫𝑭𝑺序列。对于一个连通图，由深度优先搜索算法进行遍历得到的结点次序（𝐷𝐹𝑆序列），以及相应结点之间的边所构成的图称为深度优先生成树。对于一个非连通图，由深度优先搜索算法进行遍历得到的结点次序（𝐷𝐹𝑆序列），以及相应结点之间的边所构成的图称为深度优先生成森林。  

### 8.4.2  广度优先搜索  

广度优先搜索不同于深度优先搜索一层层地在每个遍历点处向下递归搜索的纵向搜索，而是以一种广度的思维进行横向搜索。对于一个给定的连通图$G=(V,E)$，同样地，需要先确定一个出发点，访问并将其标记为已访问之后，依次遍历其所有未被访问的邻接点 $v_{i},v_{i+1},v_{i+2}\ldots v_{i+k}$，访问之后同样进行标记，然后分别从结点$v_{i},v_{i+1},v_{i+2}\ldots v_{i+k}$开始依次遍历每个点的未被访问的点，依次类推，直到图中所有顶点都被访问为止。这个过程称为广度优先搜索，简称𝑩𝑭𝑺。  

同样地，对广度优先搜索算法进行整理并拓广为非连通图的情况下的算法如下：  

（1）首先确定一个出发点$v_{i}$，访问并将其标记为已访问。 

（2）依次访问$v_{i}$ 的每个尚未访问的邻接点$v_{i},v_{i+1},v_{i+2}\ldots v_{i+k}$ 

（3）分别将这些邻接点$v_{i},v_{i+1},v_{i+2}\ldots v_{i+k}$作为遍历点，依次访问每个遍历点的尚未访问的邻接点并标记为已访问，同时要记录每个邻接点被访问的顺序，在访问完所有邻接点之后应该按照这个顺序，将这些邻接点$v_{i},v_{i+1},v_{i+2}\ldots v_{i+k}$分别作为当前遍历点进行广度优先搜索），依次类推，直到所有结点都被访问完为止。 

（4）若此时还有顶点未被访问，则继续选一个未被访问的顶点作为起始点，重复上述过程，直至所有顶点均被访问过为止  

在对图进行广度优先遍历时，按照结点的先后的被访问次序所组成的序列，称为广度优先搜索序列，简称𝑩𝑭𝑺序列。对于一个连通图，由广度优先搜索算法进行遍历得到的结点次序（𝐵𝐹𝑆序列），以及相应结点之间的边所构成的图称为广度优先生成树。对于一个非连通图，由广度优先搜索算法进行遍历得到的结点次序（𝐵𝐹𝑆序列），以及相应结点之间的边所构成的图称为广度优先生成森林。    

### 8.4.3 单源最短路径  

最短路径，顾名思义就是图中一个结点到另一个结点的之间最短的距离。

迪杰斯特拉算法的基本思想如下：  

假定有两个集合 $A$ 和 $B$ ，$A$ 集合中存放已找到最短路径的结点$B$集合中存放的是剩余结点。初始状态下，集合 $A$ 中包含默认的源点 $v_{1}$ ，然后从集合 $B$ 中选取到结点$v_{1}$最近的那个结点，记为 $v_{2}$，将 $v_{2}$ 放入集合 $A$ 中，并对$ v_{2}$到$v_{1}$的距离进行永久性标注，然后再以 $v_{2}$ 为中介点，更新 $v_{1}$ 到其他剩余结点的最短路径临时值。然后再从集合B中选取最近的结点，并入集合 $A$ 中，并对该结点到$v_{1}$的最短路径临时值进行永久性标注，使得该临时值变成永久值，重复以上过程，直到将集合B中的所有结点全部并入集合 $A$ 中并得到永久性标注。  

迪杰斯特拉算法的数学描述如下： 

（1）初始化：$A=\{v_1\},d(v_1)=0,B=\{v_i|v_i\in V,i\neq1\}$,即 $B=V-A$,且有
$$d(v_i)=\begin{cases}\omega(v_1,v_i),~~~~~~~若(v_1,v_i)\in E\\\infty,~~~~~~~~~~~~~~~~~若(v_1,v_i)\notin E\end{cases}$$              (8-13) 

（2）找最近：在 $B$ 集合中寻找离顶点 $v_{1}$ 最近的结点。若为 $v_{k}$ ，则将 $v_{k}$ 添加到集合 $A$ 中，并在 $B$ 集合中删除 $v_{k}$ ，即 $A=A\cup\{v_{k}\}$，$B=B-\{v_{k}\}$  

（3）更新：以 $v_{k}$ 为中介点，更新 $v_{1}$ 到 $B$ 集合中剩余结点的最短路径长度。$\forall$$v_{i}\in$$B$，  

$d(v_{i})={\left\{\begin{array}{l l}{d(v_{k})+\omega(v_{k},v_{i}),~~~~~~~~~~~~~~若\dot{}d(v_{k})+\omega(v_{k},v_{i})<d(v_{i})}\\ {\qquad d(v_{i}),~~~~~~~~~~~~~~~~~~~~~~~否则}\end{array}\right.}$      （8 −14）  

（4）重复（2）和（3），直到 $B$ 集合为空为止。  

实际上，当 $v_{n}$ 归入集合 $A$ ，且正好 $A=V$，不仅求出了从 $v_{1}$ 到 $v_{n}$ 的最短路径，而且求出了从 $v_{1}$ 到所有顶点的最短路径。  

上述算法的正确性是显然的。因为每一步中，集合 $A$中的每一个元素（顶点）都是 $v_{1}$ 到该元素（顶点）的最短路径，因此只要证明上述 $d(v_{i})$ 是从 $v_{1}$ 到 $v_{i}$ 的最短路径即可。  

事实上，任何一条从 $v_{1}$ 到 $v_{i}$ 的路径，若通过集合 $B$ 中的第一个顶点是 $v_{p}$，且 $v_{p}\neq$$v_{i}$ ，显然这种路径的长度不会比 $d(v_{i})$小（因为所有边的权值为非负）。  

### 8.4.4 多源最短路径  

迪杰斯特拉算法解决的是单源最短路径问题，只能求出单独某个源点到其它结点最短路径，然而沃舍尔∙弗洛伊德算法则是求得这个图中任意对结点之间的最短路径长度。  

沃舍尔∙弗洛伊德算法的基本思想是通过逐次增加中介结点的途径，不断优化和更新图中每对结点之间的路径长度。首先，将$v_{1}$作为中介结点，据此更新图中仅以$v_{1}$作为中介结点的路径长度以及相应的路径记录。然后在$v_{1}$的基础上，进一步引入${{v}}_{2}$作为新增的中介结点，并更新图中仅以$v_{1}v_{2}$作为中介结点的路径长度和路径记录。依次类推，在$v_{1}v_{2}v_{3}\ldots v_{k}$作为中介结点的基础上，以$v_{k}$作为新增中介结点计算并更新图中以$v_{1}v_{2}v_{3}\ldots v_{k}$为中介结点的每对结点之间路径长度和路径记录。这样当$k=n$(𝑛为结点个数)时，便可求出图中每对结点的最短路径长度及其相应的路径记录。  

具体地说，沃舍尔∙弗洛伊德算法的基本步骤如下：  

（1）首先进行初始化操作。  

$$
R^{(0)}\big(v_{i},v_{j}\big)=v_{j}
$$

（2）按如下的原则，将图中的每个结点$v_{k}(k=1,\!2,\dots,n)$分别作为中介结点，更新$D$和$R$矩阵，依次获得矩阵$D^{(1)},D^{(2)},\dots,D^{(n)}$和$R^{(1)},R^{(2)},\ldots,R^{(n)}$。  

(i)若$D^{(k-1)}\big(v_{i},v_{j}\big)>D^{(k-1)}(v_{i},v_{k})+D^{(k-1)}\big(v_{k},v_{j}\big),$  则，

$$
D^{(k)}\!\left(v_{i},v_{j}\right)\!\!=\!\!D^{(k-1)}(v_{i},v_{k})\!+\!D^{(k-1)}\!\left(v_{k},v_{j}\right)\!;\,\,\,R^{(k)}\!\left(v_{i},v_{j}\right)=v_{k}
$$

(ii)  若 $ D^{(k-1)}\!\left(v_{i},v_{j}\right)\leq D^{(k-1)}\!\left(v_{k},v_{j}\right)\!+\!D^{(k-1)}\!\left(v_{k},v_{j}\right)$ ，则，   $D^{(k)}\!\left(v_{i},v_{j}\right)\!\!=\!\!D^{(k-1)}\!\left(v_{i},v_{j}\right)\!;\,\,\,R^{(k)}\!\left(v_{i},v_{j}\right)=R^{(k-1)}\!\left(v_{i},v_{j}\right)$  

（3）根据矩阵${ D}^{(n)}$和$R^{(n)}$，计算任意结点之间的最短路径长度和路径序列。以$v_{i}$和$v_{j}$为例计算两者的最短路径序列：若$R^{(n)}=v_{k}$，则在$v_{i}$到$v_{j}$的最短路径中必有中间结点$v_{k}$，那么根据如下规则，分别向$v_{k}$两头追溯一定可以得到$v_{i}$到$v_{j}$的最短路径：  

(i) 向点$v_{i}$方向追溯可以得到：  

$$
R^{(n)}(v_{i},v_{k})=v_{k-1},\ R(v_{i},v_{k-1})=v_{k-2},...,\ R^{(n)}(v_{i},v_{k-m})=v_{i}
$$

(ii) 向点$v_{j}$方向追溯可以得到：  

$$
R^{(n)}\big(v_{k},v_{j}\big)=v_{k+1},\ R^{(n)}\big(v_{k+1},v_{j}\big)=v_{k+2},...,\ R^{(n)}(v_{i},v_{k+s})=v_{j}
$$

由此可见，通过路径长度矩阵$D$和路径记录矩阵$R$，可以求出图中任意一对结点之间的最短路径。  




## §  8.5  图模型的应用

图模型实现了形象思维与抽象思维的完美结合，是一种非常有效的数学模型和工具，在解决如计算机网络路由问题、送快递的最短路径问题、网站之间的链接模型问题、工程预算的关键路径问题、软件代码复杂度计算问题等诸多复杂问题中发挥至关重要、不可替代的作用。本节通过若干具体实例介绍图模型的应用技术。  

### 8.5.1 交通灯相位问题  

现实生活中，为了避免不同方向交通流之间的相互冲突，可以通过在时间上给各个方向交通流分配相应的通行权。例如，为了放行东西向的直行车流且同时避免南北向的直行、左转车流与其发生冲突，可以通过启亮东西向的绿色直行箭头灯将路口的通行权赋予东西向的直行车流，启亮南北向的红灯消除南北向直行、左转车流对东西向直行车流通行的影响。  

对于一组互不冲突的交通流同时获得通行权所对应的信号显示状态，我们将其称之为信号相位，简称为相位。可以看出，交通灯信号相位是根据交叉口通行权在一个周期内的更迭来划分的。一个红绿灯信号控制方案在一个周期内有几个信号相位。一个路口采用几相位的信号控制应由该路口的实际交通流状况决定，十字路口通常采用2 到4 个相位。如果相位数设计的太少，则不能有效的分配好路口通行权，路口很容易出现交通混乱，交通安全下降；如果相位数设计的太多，虽然路口的交通次序与安全性得到了改善，但由于相位之间进行转换时都会损失一部分通行时间，过多的相位数会导致路口的通行能力下降，延长司机在路口的等待时间。  

### 8.5.2 作业规划问题  

生活中有着多种多样的工程，而每一项工程往往都是由多种不同的活动相互组合而成，这些活动中，有的可以并行执行，而有的活动却必须要等到前面的准备活动都做好之后才能开始进行。例如，在一个软件开发项目中，包括以下几个阶段：需求分析，系统设计，模块代码编写，单元测试，软件维护。其中代码编写和单元测试可以同时进行，但是代码编写却一定要在需求分析和系统设计完成之后才行，需求分析和系统设计构成了代码编写的准备工作。既然存在这样的现象，那么在一项很复杂的工程中，如何合理的安排活动的进行，能够使得整个工程完成时间最早呢？其实，这就是关键路径问题。在求解关键路径问题之前，我们有必要先了解下PERT 图的相关概念。  

PERT 图是一个有向连通图$G=\langle V,E\rangle$，且  

（1）每条边表示一个作业（工序），边的非负实数权表示完成该作业所需的时间； 

（2）每个顶点表示以该顶点为起点的作业开始，也表示以该顶点为终点的作业结束；

（3）作业开始条件：某条有向边$e=\langle v,u\rangle$所代表的作业可以开始 当且仅当 以v为终点的有向边所代表的作业全部完成； 

（4）G没有有向回路，也没有环；  

（5）G中有且仅有一个顶点的入度为0，称该顶点为源点；同时G中有且禁言一个顶点的出度为0，称该顶点为汇点。  

对于给定的PERT 图$G=\langle V,E\rangle$，我们主要关心其关键路径，以及每个作业的最早开始时间和最晚开始时间。关于PERT 图，有如下定义：  

（1）关键路径：G中从源点到汇点最长带权路径路径称为关键路径。关键路径的长度T为完成整个任务（即包括所有作业）所必需的最少时间。  

（2）关键作业：关键路径上的边所代表的作业称为关键作业。  

（3）最早启动时间：对于某个作业${e}=\left<v_{i},-\right>$，源点到该作业起点$v_{i}$的最长路径长度$\pi_{i}$称为该作业的最早启动时间。  

（4）最晚启动时间：设$v_{i}$到汇点${v}_{n}$的最长路径长度为$\pi_{i}^{\prime}$，则该作业可最晚于$\mathsf{\Delta}\mathsf{T}_{i}=\mathsf{T}-$$\uppi_{i}^{\prime}$时间启动而不影响整个任务完成的预期时间T，$\uptau_{i}$称为该作业的最晚启动时间。  

显然，作业${e}=\langle v_{i},-\rangle$是关键作业当且仅当$\pi_{i}=\uptau_{i}$，因为这时e是处于源点到汇点最长带权路径上。故可通过求每个作业的最早启动时间和最晚启动时间而得到PERT 图的关键路径。那么如何求解作业的最早启动时间和最晚启动时间呢？下面给出了求解方法：  

设PERT 图$G=\langle V,E\rangle$的顶点编号$v_{1},v_{2},\dots,v_{n}$，使得边$e=\langle v_{i},v_{j}\rangle\in E$蕴含$i<j$  

令$\pi_{1}=0$，$\pi_{j}=m a x\{\pi_{m}+w(v_{m},v_{j})|1\leq m<j\}$，则$\pi_{i}(1\leq i\leq n)$是作业$e=\langle v_{i},v_{j}\rangle$的最早启动时间。这里$w(v_{m},v_{j})$定义为：  

$w(v_m,v_j)=\begin{cases}\text{边}\langle v_m,v_j\rangle\text{的非负实数权,~~~~~~~~若}\langle v_m,v_j\rangle\in E;\\-\infty,&\text{否则}\end{cases}\text{(8-18)}$

令$\tau_{n}=\pi_{n}$，$\tau_{k}=m a x\{\tau_{k},\tau_{k}-w(v_{k},v_{m})|k<m\leq n\}$，则$\tau_{i}(1\leq i\leq n)$是作业$e=$$\langle v_{i},v_{j}\rangle$的最晚启动时间。  

由于某顶点的最早启动时间（最晚启动时间）就是所有以该顶点为起点的作业的最早启动时间（最晚启动时间）。因此求解关键路径，可以通过计算每个顶点的最早启动时间和最晚启动时间来确定。  

另外，为了更方便的判断顶点$v_{i}$是否为关键路径上的顶点，在此定义$v_{i}$的缓冲时间$S_{i}=$$\tau_{i}-\pi_{i}$。在关键路径上，各顶点的缓冲时间𝑆均为0，任何关键作业如果耽误了时间𝑡，整个工程就耽误了时间𝑡。下面给出求解关键路径的具体例子。  

### 8.5.3 机器学习问题  

1959 年，美国塞缪尔教授设计了一个具有学习能力的下棋程序。它可在不断对弈中改善自己的棋艺。4 年后，该程序战胜了设计者本人。又过3 年，该程序战胜了美国常胜冠军。由此可以看出机器学习的能力，特别是当下谷歌设计的AlphaGo 程序与围棋大师李世石的围棋大战，更是体现了机器学习的威力。所谓机器学习，就是数学模型或求解算法中具有似于人类的学习机制，能够从实际问题中采集适当样本数据，根据样本数据自动算出参数值，并随着样本数据的变化自动调整参数取值，使得数学模型和求解算法具有良好的普适性和自适应性。按机器学习的模型结构层次来分，机器学习经历了两次浪潮，分别是浅层学习和深度学习。近年来，机器学习的概念异常火爆，各种机器学习算法层出不穷。本小节简要介绍图模型在浅层学习和深度学习中的与应用。  

简单地说，深度学习就是对拥有深层结构的模型进行训练。所谓深层结构，是相对于前述的浅层结构而言的，两者的差异主要在于拥有的非线性运算单元的层数不同。深层结构是指非线性转换单元的层数大于或等于两层的模型，而使用多层模型的优势即可以使用较少的参数表示复杂的函数


深度学习在模型中构建多层隐含层，并通过大量样本训练模型参数，获得更有用的特征，从而有效提升分类或预测的准确性。相比较传统的浅层结构，深度学习更强调了模型结构的深度，通常有5 至6 层隐含层，有的模型结构甚至包含10 层以上隐含层。此外，深度学习明确突出了特征学习的重要性。深度学习实现多层堆叠，每一层的输出作为下一层的输入，高层的特征是低层特征的组合，从低层到高层的特征表示越来越抽象，越来越能表现语义或者意图。而抽象层面越高，存在的可能猜测就越少，就越利于分类。换句话说，深度学习通过逐层特征变换，将样本在原始特征空间表示逐层变换到新的特征空间，从而使分类或预测的效果更加准确。图8-77 表示一个含多隐含层的深度学习模型。事实上，由如图8-78 所示自动编码器组合或其简单变形的模型也可看成是深度结构，例如堆叠自动编码器，稀疏自动编码器等。  

深度学习是机器学习发展的产物。与传统的机器学习方法相比，深度学习优势明显，目前在图像识别、语音识别、自然语言理解等领域得到广泛的应用。  
